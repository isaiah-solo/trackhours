language: go
go:
- 1.12
env:
  global:
  - COMMIT=${TRAVIS_COMMIT::8}
  - secure: LdSuPI0aL7jlzohRApP5Vt1oJ3Ic9l+O5aadTkZ6YVS20EMRVaQwNXZl1pr+gaIm2ZkdkqL/no5gFwTjSYSy+ksF++TYY/oqOG94eYa/ESwCnmfExJ7RySP0LpYuBQ8ZmjjGWXvqk3ouarSavRb/tg6bsPWFzMLAA1qYjze9N6C8MNfVvKgpnem0GGy0q/KmXZkoLipcenWBxTfPTyYFV+SDmDY8fU9WtLywFcMnzVltVttyFmGRgz2Ge4dT6mSdw+9LXqa21uzripGLgLDZSM/8PL9e0dVxJSHaMDymmek+sOkWeWftDDOIY52XZzVXKZiqfjyoHYwsUATpqkHSotXKFxwV4n13Hha67IqYAAIZbPxRZucuPP8BElENYoskmInYQ3MGstKMUfX7TKx64LuxHkRLGD03Gp/Y1lEXcuwLglai9AdLg2YzKxuW4uXi7bkaRhhV5VJ7gIOpd79ne3pGajRRHSwUEERxQXwaO+yuTWjjxTJgPnUfzIKrxx0lQinmj9s89RvD2o4kqJLAhDVRyR0aldoWW3ZBAgxPIE/lIe5dOcvufryy3CeEyDp/maGT2Zd/vZxZnvj4zOuFG545uERAbLqnZt6crJGEA93WHuVUsgc2EY1mXYcifXY9IFketcnLostKGFYo5cXB/3nvKy1iA7oS8HNK9cU8xlI=
  - secure: KUYyGPz+R/CT2ZsrcUYgcAJgQTXOtDWqCX+zKTypA2CQJCfcqXjUF7udDO52duYGOy0GezaCQQwLGKAr2IOH1j6OJXobTY1sVSNt2Hf/wwgzW3TCPtaVaT+1cvqJsjzb/F+FdpNYOYflz7oh/ufIVNRXaCQm6GmoNPa9ooHsPJCkGmRuQWM5EcIotAhjEYMREKyZK3nnBmacR0U+9wYphffPTZ3HnsRPU6kA2Bwkpr7NxthDNwgLR+4BhKPAXg1Bs1hokETxw1m042xPd1+l/D33sBLk7umscW6AcceWmRv/sRmVDxzgfK5rKYyPjF2cBcUdY94hqEc/ifer8Ax0ls6lZWmaY24z3b+Egw7HuX/ZFTca8I4gw8kJUZfmJ1gIlPZ+A01IcJN5sBN/xhBEf3XQGm5+hIISWgljYCSzXVkkws0f8UeZtqGdPKBCsi46xwpAMlYvhS+9UjgC6uYYhhFDd0vkkRGQ7Bj9n1b5Yk7y2p8tcAmZF0xpwEAUkYb7sgX2JCoP2flg2EN4rO7n+PTpVH1Ik9vsjAD4OY+u7964mWBsVKPwH+Z20QynQIGK0a8/kTwENFkwNm4RjIuqmM6ux/0DUWuQvKvyXEHHuBHPmdtiDR7kYAMAH9Wct5ZvT1lJalObRehFOp3TzTnb0/DFtW8gfYOd1ZCWn+BMN1g=
  - secure: UYvdI8ERuv15Bd3AdXt5CBpRvfDj2X8tx7ziVUXJADrEgCZar2nrSveEkYnWgVsd6YKd8y71KDr0RVHyVLD8ygJSFuxkr9zusPfHP9hNqoFVx1IdcIlRUXQuzZnqe3dOcROe05ZblLgMdImmMqOB6AvDlis4WAo1CdQc1m4hbOHMSjYcnS5q+iZEDqSRGfWV7foPgbrFxtORy6Sy2zP1cCdLgArMAkHkv1fTO52dmTRFHK65MoSld5i/Rxv/WX0qAzg2dMxPk1jQ3nfTVF4x34IoEj5UkHE/sYWkyyC8hKCaJb/cqb8+Z27Z90vWkR883KpJF9A65Gno5dhSUOpzz2t1Jh+EfTe5Ly8SDUIu7+NxqAURvnkPkrdusNk9kjqxKfd/WTgIWK2B4IWzg0w0VLz6AGYgbBz3ATPEw1bYgf1RoWdMrvm8AD2BK7geRSnHQ1M5kLtdTaQVk5mDoQeMveVkrFi+TrRce8Ul7XIcfNlVJzDmsKGgikqWHGOqB32OSHexyexfk95DEv/6aL0UN/Om5xwMrIj4GGsZI2moS5aZcOqwrwBaCCJKHuDUWRD9UfBdYm/6I3FyuLj5m/O0pzqy+ZsAtJII7dAXeSpNfRI3VWJzjnO9S8+DgHqF0bBlE3muYceWwp7G4KW7IVULBV4jpJLBOwOfEX1GZHxd0Sc=
  - secure: VO9vhy/NsxLNb35HEe8hAKh8CV0uxMCkzR6EQIOE/EegyuYaoKTcVPLmlrWgjXyM3ZhW8YdBDT9aeKsl4g3aHALKlivIVYsge8HM+K119U3Ah/LeKMyw0/RAjgY5GivPiTv8h3rZTqOP+FFH+y6TZCVmSvivb5RY3nCdPicoGDP3lF31iwNWYXlPKKlgEePdY7jTIz9L4BP7mSgvPxsA3FOWRFFnr2k9OUyezJXLTVEfZzsRvJkUW+9wV0RB4kFL4/uOdYLZYXnHhCpNY3fBtRXQKkfZweTDf1CJY6z8NMnEToBwFAnWjYVpp35MHjNsBxHNXzKIhGkGyc4jj0hgbWTxMoeIAaHXzdessRu9VKZ4Db4yGHcNxyP34q/j1UpWxK3LZ/w9+vsDSm6WogBlE2PW3K0Y27Xtbo8ZeKuROsdZvZkugF2d7QK6ZFWE+5gKUYPnj5lc2y5i5NXV2ATBfpeXiEV91fXWdkm+BS7wpGGFed2lueFSG5ot95eqg9Qwfu8L08On7PkRaPXTr1InX+azL0QdjB6HsxCo0pbF9nWqjA3YLfUsHGJannM1XrldlpmDPm4aSld03MUxEvsAOnYxCl88WJzBC9+90zN6wSe+CECSIa2KdxgBfjlAp+vMoe5sJtQebQHYOtt2LLFchqfs6yx8FDcduH8zINh8Nnc=
script: 
after_success:
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- export REPO=isaiahsolo/trackhours
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH
  ; fi`
- docker build -f server/Dockerfile -t $REPO:$COMMIT .
- docker tag $REPO:$COMMIT $REPO:$TAG
- docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
- docker push $REPO
